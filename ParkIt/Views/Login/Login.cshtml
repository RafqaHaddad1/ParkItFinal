
@{
    ViewData["Title"] = "Login";
    Layout = null;
}
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="@Url.Content("~/css/Login.css?v=w")" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0">

<form id="loginForm">
    <div class="d-flex flex-row login">
        <div class="login-form d-flex flex-column justify-content-center align-items-center">
            <img src="@Url.Content("../Images/nav_logo.png")" class="logo" />

            <div class="form-group">
                <label class='mb-2'><i class="fas fa-user"></i> Username</label>
                <input id="username" name="Name" type="text" class='form-control' placeholder="Username" required="required">
            </div>

            <div class="form-group mt-4">
                <label class='mb-2'><i class="fas fa-lock"></i> Password</label>
                <input id ="password" name="Password" type="password" class='form-control' placeholder="Password" required="required">
            </div>

         
            
            <button type="submit" class="custom-button mt-4">Login</button>

            <!-- Error Message -->
            <div id="errorMessage" class="alert alert-danger" style="display:none;"></div>
        </div>
        <div class="bg">
            <img src="@Url.Content("../Images/LoginDesign.jpg")" />
        </div>
    </div>
</form>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    $("#loginForm").submit(function (event) {
        event.preventDefault(); 

        var username = $("#username").val();
        var password = $("#password").val();
        sessionStorage.setItem("username", username);
        $.ajax({
            type: "POST",
            url: "https://api.parkit.nova4lb.com/admin/auth",
            data: {
                username: username,
                password: password
            },
            success: function (response) {
                if (response.accessToken) {
                    // Redirect to the dashboard if login is successful
                    window.location.href = "/Views/Home";
                } else {
                    // Show error message
                    alert(response.message || "Login failed");
                }
            },
            error: function (xhr, status, error) {
               
                alert("An error occurred: " + error);
            }
        });
    });

</script>